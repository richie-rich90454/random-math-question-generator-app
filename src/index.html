<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>RandMatQuGeA</title>
        <meta name="application-name" content="RandMatQuGeA">
        <meta name="theme-color" content="#28465C">
        <link rel="icon" href="/favicon.png" type="image/png">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="stylesheet" href="/katex.min.css">
        <script src="/katex.min.js"></script>
        <link rel="stylesheet" href="style.css">
        <script>
            window.MathJax={
                tex: {
                    inlineMath: [["$", "$"], ["\\(", "\\)"]],
                    displayMath: [["$$", "$$"], ["\\[", "\\]"]]
                },
                svg: {
                    fontCache: "global"
                },
                options: {
                    ignoreHtmlClass: "tex2jax_ignore",
                    processHtmlClass: "tex2jax_process"
                }
            };
        </script>
        <script id="MathJax-script" async src="/mathjax/tex-chtml.js"></script>
    </head>
    <body>
        <div id="wave-container">
            <div class="liquid-bg"></div>
        </div>
        <div id="blur-layer"></div>
        <div class="app-container">
            <div class="app-content">
                <div class="control-toolbar">
                    <div class="toolbar-row-top">
                        <div class="mode-selector" role="group" aria-label="Mode selection">
                            <button id="mode-single" class="mode-button active" aria-pressed="true">Single</button>
                            <button id="mode-mental" class="mode-button" aria-pressed="false">Mental</button>
                        </div>
                        <div class="toolbar-section">
                            <h2 class="toolbar-title" id="topics-heading">Topics</h2>
                            <div class="topic-pills-container" id="topic-grid" role="group" aria-labelledby="topics-heading"></div>
                        </div>
                        <div class="utility-buttons">
                            <button class="icon-button" id="theme-toggle" aria-label="Toggle theme">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"/>
                                </svg>
                            </button>
                            <button class="icon-button" id="help-button" aria-label="Help">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/>
                                </svg>
                            </button>
                            <button class="icon-button" id="settings-button" aria-label="Settings">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94 0 .31.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5-.38 1.03-.7 1.62-.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.57 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="toolbar-row-bottom">
                        <div class="toolbar-actions" id="single-controls">
                            <div class="single-actions">
                                <button class="primary-button toolbar-button" id="genQ">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
                                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                    </svg>
                                    Generate
                                    <kbd class="shortcut-hint">Ctrl+G</kbd>
                                </button>
                                <button class="secondary-button toolbar-button" id="check-answer" disabled aria-disabled="true">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
                                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                    </svg>
                                    Check
                                    <kbd class="shortcut-hint">Shift+Enter</kbd>
                                </button>
                            </div>
                            <div class="auto-controls">
                                <label class="auto-toggle" id="auto-label">
                                    <input type="checkbox" id="autocontinue-toggle" aria-checked="false"> Auto (3s)
                                </label>
                                <select id="scope-select" class="scope-select" aria-label="Scope">
                                    <option value="simple">Simple Math</option>
                                    <option value="algebra">Algebra</option>
                                    <option value="precalc">Precalculus</option>
                                    <option value="calc">Calculus</option>
                                    <option value="all">All</option>
                                </select>
                                <label class="shuffle-toggle" id="shuffle-label">
                                    <input type="checkbox" id="shuffle-toggle" aria-checked="false"> Shuffle
                                </label>
                            </div>
                        </div>
                        <div id="mental-controls" class="mental-controls-wrapper" style="display: none;">
                            <div class="mental-stats">
                                <select id="difficulty-select" class="difficulty-select" aria-label="Difficulty">
                                    <option value="easy">Easy</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="hard">Hard</option>
                                </select>
                                <span id="timer-display" class="stat-with-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                                    </svg>
                                    00:30
                                </span>
                                <span id="score-display" class="stat-with-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                    </svg>
                                    0 / 0
                                </span>
                                <button class="icon-button" id="pause-session" aria-label="Pause" style="display: none;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                                    </svg>
                                </button>
                                <button class="icon-button" id="skip-question" aria-label="Skip" style="display: none;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="mental-extra-controls">
                                <select id="mental-scope-select" class="scope-select" aria-label="Mental scope">
                                    <option value="simple">Simple Math</option>
                                    <option value="algebra">Algebra</option>
                                    <option value="precalc">Precalculus</option>
                                    <option value="calc">Calculus</option>
                                    <option value="all">All</option>
                                </select>
                                <label class="shuffle-toggle" id="mental-shuffle-label">
                                    <input type="checkbox" id="mental-shuffle-toggle" aria-checked="false"> Shuffle
                                </label>
                                <button id="start-session" class="primary-button">Start Session</button>
                            </div>
                            <div class="mental-progress">
                                <div class="progress-bar" id="mental-progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="main-content">
                    <div class="content-stack">
                        <div class="question-card card">
                            <div class="card-header">
                                <h2 class="card-title">Question</h2>
                                <div class="card-subtitle" id="current-topic">Select a topic</div>
                            </div>
                            <div class="card-content">
                                <div id="question-area" class="question-display" aria-live="polite" role="region" aria-label="Question display">
                                    <div class="empty-state">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
                                            <path d="M11 7h2v2h-2zm0 4h2v6h-2z"/>
                                        </svg>
                                        <p>Pick a topic and click <strong>Generate</strong> to start</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="answer-section">
                            <div class="answer-card card">
                                <div class="card-header">
                                    <h2 class="card-title">Your Answer</h2>
                                </div>
                                <div class="card-content">
                                    <div class="math-toolbar" id="math-toolbar">
                                        <button class="math-toolbar-btn" data-symbol="\int">∫</button>
                                        <button class="math-toolbar-btn" data-symbol="\sum">∑</button>
                                        <button class="math-toolbar-btn" data-symbol="\sqrt{}">√</button>
                                        <button class="math-toolbar-btn" data-symbol="\pi">π</button>
                                        <button class="math-toolbar-btn" data-symbol="\infty">∞</button>
                                        <button class="math-toolbar-btn" data-symbol="\pm">±</button>
                                        <button class="math-toolbar-btn" data-symbol="\approx">≈</button>
                                        <button class="math-toolbar-btn" data-symbol="\neq">≠</button>
                                        <button class="math-toolbar-btn" data-symbol="\le">≤</button>
                                        <button class="math-toolbar-btn" data-symbol="\ge">≥</button>
                                    </div>
                                    <textarea id="answer-box" class="answer-input" placeholder="Enter your answer here. Use Shift + Enter to submit." disabled aria-describedby="expected-format symbols-hint"></textarea>
                                    <div id="preview" class="math-preview"></div>
                                    <div class="symbols-hint" id="symbols-hint">
                                        <span class="hint-label">Symbols:</span>
                                        <span class="symbols-list">∫ ∑ √ π ∞ ± ≈ ≠ ≤ ≥</span>
                                    </div>
                                    <div id="expected-format" class="expected-format"></div>
                                </div>
                            </div>
                            <div class="results-card card">
                                <div class="card-header">
                                    <h2 class="card-title">Results</h2>
                                    <button class="icon-button" id="copy-answer" aria-label="Copy correct answer" style="display: none;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="card-content">
                                    <div id="answer-results" class="results-display" role="status" aria-live="polite">
                                        <div class="empty-state">
                                            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"/>
                                            </svg>
                                            <p>Your results will appear here after checking</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="app-footer">
                <div class="footer-content">
                    <span class="footer-text">RandMatQuGeA v<%= version %></span>
                    <span class="footer-text">© 2026 Richard's Blogs</span>
                </div>
            </div>
        </div>
        <div id="settings-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="settings-title">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="settings-title">Settings</h2>
                    <button class="icon-button modal-close" id="settings-close" aria-label="Close settings">✕</button>
                </div>
                <div class="modal-body">
                    <div class="settings-section">
                        <h3>Appearance</h3>
                        <div class="setting-item">
                            <label for="settings-theme">Theme</label>
                            <select id="settings-theme" class="scope-select">
                                <option value="system">System</option>
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="settings-font">Font</label>
                            <select id="settings-font" class="scope-select">
                                <option value="default">Default</option>
                                <option value="opendyslexic">OpenDyslexic</option>
                            </select>
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>General</h3>
                        <div class="setting-item">
                            <label for="settings-default-mode">Default mode</label>
                            <select id="settings-default-mode" class="scope-select">
                                <option value="single">Single</option>
                                <option value="mental">Mental</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="settings-auto-continue">Auto-continue (Single mode)</label>
                            <input type="checkbox" id="settings-auto-continue" class="settings-checkbox">
                        </div>
                        <div class="setting-item">
                            <label for="settings-shuffle">Shuffle by default</label>
                            <input type="checkbox" id="settings-shuffle" class="settings-checkbox">
                        </div>
                        <div class="setting-item">
                            <label for="settings-scope">Default scope</label>
                            <select id="settings-scope" class="scope-select">
                                <option value="simple">Simple Math</option>
                                <option value="algebra">Algebra</option>
                                <option value="precalc">Precalculus</option>
                                <option value="calc">Calculus</option>
                                <option value="all">All</option>
                            </select>
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>Mental Mode</h3>
                        <div class="setting-item">
                            <label for="settings-difficulty">Difficulty</label>
                            <select id="settings-difficulty" class="scope-select">
                                <option value="easy">Easy</option>
                                <option value="medium">Medium</option>
                                <option value="hard">Hard</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="settings-timer">Timer (seconds)</label>
                            <input type="number" id="settings-timer" min="10" max="120" value="30" class="settings-number">
                        </div>
                        <div class="setting-item">
                            <label for="settings-max-questions">Questions per session</label>
                            <input type="number" id="settings-max-questions" min="1" max="20" value="5" class="settings-number">
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>Performance</h3>
                        <div class="setting-item">
                            <label for="settings-perf-master">Performance mode (disables eye candy)</label>
                            <input type="checkbox" id="settings-perf-master" class="settings-checkbox">
                        </div>
                        <div class="setting-item">
                            <label for="settings-perf-wave">Wave background</label>
                            <input type="checkbox" id="settings-perf-wave" class="settings-checkbox" checked>
                        </div>
                        <div class="setting-item">
                            <label for="settings-perf-blur">Blur effects</label>
                            <input type="checkbox" id="settings-perf-blur" class="settings-checkbox" checked>
                        </div>
                        <div class="setting-item">
                            <label for="settings-perf-preview">Live preview (KaTeX)</label>
                            <input type="checkbox" id="settings-perf-preview" class="settings-checkbox" checked>
                        </div>
                        <div class="setting-item">
                            <label for="settings-perf-animations">Animations</label>
                            <input type="checkbox" id="settings-perf-animations" class="settings-checkbox" checked>
                        </div>
                        <div class="setting-item">
                            <label for="settings-fps-cap">FPS cap (for JS animations)</label>
                            <select id="settings-fps-cap" class="scope-select">
                                <option value="30">30</option>
                                <option value="60">60</option>
                                <option value="90">90</option>
                                <option value="120">120</option>
                                <option value="0" selected>Screen (no cap)</option>
                            </select>
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>Data</h3>
                        <div class="setting-item">
                            <button class="secondary-button" id="settings-reset">Reset to defaults</button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="primary-button" id="settings-save">Save & Close</button>
                </div>
            </div>
        </div>
        <div id="custom-context-menu" style="display: none; position: fixed; background: var(--surface-elevated); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: var(--spacing-xs); box-shadow: var(--shadow-lg); z-index: 10000;">
            <button class="context-menu-item" data-action="paste">Paste</button>
            <button class="context-menu-item" data-action="clear">Clear</button>
        </div>
        <script type="module" src="script.ts"></script>
    </body>
</html>